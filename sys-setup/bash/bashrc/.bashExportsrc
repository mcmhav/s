#!/bin/bash

# old stuff
# export EDITOR=subl3
# export VISUAL=subl3
# export HISTFILESIZE=
# export HISTSIZE=

# pyenv
export PYENV_ROOT="$HOME/.pyenv"

# go sgit
export GOPATH="$HOME/.go"
export GOROOT=/usr/local/opt/go/libexec

# android
export ANDROID_HOME=/usr/local/share/android-sdk

# path stuff
PATH="/git/tools/bin:${PATH}"
PATH="$PATH:$(ruby -rubygems -e "puts Gem.user_dir")/bin"
PATH="$PATH:/git/bob"
# PATH="$PATH:`yarn global bin`"
PATH="$PATH:/usr/local/bin"
PATH="$PATH:/Users/mcmhav/work/bin/protoc-gen-go"
PATH="$PATH:/usr/local/opt/python/libexec/bin"
PATH="$PYENV_ROOT/bin:$PATH"
PATH=$PATH:$GOPATH/bin
PATH=$PATH:$GOROOT/bin
PATH=$PATH:$HOME/r/s/sys-setup/bin

export PATH=$PATH

# node
export NVM_DIR="$HOME/.nvm"
# https://gist.github.com/fl0w/07ce79bd44788f647deab307c94d6922
NODE_GLOBALS=(`find ~/.nvm/versions/node -maxdepth 3 -type l -wholename '*/bin/*' | xargs -n1 basename | sort | uniq`)
NODE_GLOBALS+=("node")
NODE_GLOBALS+=("nvm")

# Lazy-loading nvm + npm on node globals call
load_nvm () {
  # [ -s "$(brew --prefix nvm)/nvm.sh" ] && . "$(brew --prefix nvm)/nvm.sh"
  [ -s "/usr/local/opt/nvm/nvm.sh" ] && . "/usr/local/opt/nvm/nvm.sh"
}

# Making node global trigger the lazy loading
for cmd in "${NODE_GLOBALS[@]}"; do
  eval "${cmd}(){ unset -f ${cmd}; load_nvm; ${cmd} \$@; }"
done
